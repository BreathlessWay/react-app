{"version":3,"sources":["../static/js/topic.f1b146ac.chunk.js","pages/PostTopic/index.js","webpack:///./src/pages/PostTopic/style.less?2055","pages/PostTopic/style.less"],"names":["webpackJsonp","221","module","__webpack_exports__","__webpack_require__","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","Object","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","defineProperty","__WEBPACK_IMPORTED_MODULE_0_react__","__WEBPACK_IMPORTED_MODULE_0_react___default","n","__WEBPACK_IMPORTED_MODULE_1_immutable__","__WEBPACK_IMPORTED_MODULE_2_axios__","__WEBPACK_IMPORTED_MODULE_2_axios___default","__WEBPACK_IMPORTED_MODULE_3__style_less__","_createClass","defineProperties","target","props","i","length","descriptor","key","protoProps","staticProps","PostTopic","_Component","this","_this","getPrototypeOf","state","topicInfo","title","tab","content","topicError","time","handleTitleChange","bind","handleContentChange","handleTabChange","handleTopicSubmit","handleSubmitNewTopic","handleEditTopic","baseBreadcrumb","match","params","id","path","name","setBreadcrumb","getDetail","_this2","accesstoken","entry","getIn","a","get","mdrender","then","res","result","data","setState","catch","err","errData","response","handleDialog","type","message","error_msg","e","preState","set","trim","Error","topic_id","_ref","_this3","post","success","setTimeout","history","replace","_ref2","_this4","window","clearTimeout","createElement","className","htmlFor","onChange","rows","onClick","goBack","257","exports","options","hmr","transform","locals","258","push","version","sources","names","mappings","file","sourcesContent","sourceRoot"],"mappings":"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","file":"static/js/topic.f1b146ac.chunk.js","sourcesContent":["webpackJsonp([5],{\n\n/***/ 221:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_react__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_react___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_react__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_immutable__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_immutable___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_immutable__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_axios__ = __webpack_require__(29);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_axios___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_axios__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__style_less__ = __webpack_require__(257);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__style_less___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3__style_less__);\nvar _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if(\"value\"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError(\"Cannot call a class as a function\");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");}return call&&(typeof call===\"object\"||typeof call===\"function\")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!==\"function\"&&superClass!==null){throw new TypeError(\"Super expression must either be null or a function, not \"+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}var PostTopic=function(_Component){_inherits(PostTopic,_Component);function PostTopic(props){_classCallCheck(this,PostTopic);var _this=_possibleConstructorReturn(this,(PostTopic.__proto__||Object.getPrototypeOf(PostTopic)).call(this,props));_this.state={topicInfo:Object(__WEBPACK_IMPORTED_MODULE_1_immutable__[\"Map\"])({title:'',tab:'dev',content:''}),topicError:Object(__WEBPACK_IMPORTED_MODULE_1_immutable__[\"Map\"])({title:'',content:''}),time:null};_this.handleTitleChange=_this.handleTitleChange.bind(_this);_this.handleContentChange=_this.handleContentChange.bind(_this);_this.handleTabChange=_this.handleTabChange.bind(_this);_this.handleTopicSubmit=_this.handleTopicSubmit.bind(_this);_this.handleSubmitNewTopic=_this.handleSubmitNewTopic.bind(_this);_this.handleEditTopic=_this.handleEditTopic.bind(_this);return _this;}_createClass(PostTopic,[{key:'componentDidMount',value:function componentDidMount(){var baseBreadcrumb=this.props.match.params.id?[{path:'/',name:'首页'},{path:'',name:'编辑'}]:[{path:'/',name:'首页'},{path:'',name:'发贴'}];this.props.setBreadcrumb(baseBreadcrumb);this.props.match.params.id&&this.getDetail();}},{key:'getDetail',value:function getDetail(){var _this2=this;var accesstoken=this.props.entry.getIn(['userInfo','accesstoken']);__WEBPACK_IMPORTED_MODULE_2_axios___default.a.get('/topic/'+this.props.match.params.id,{params:{accesstoken:accesstoken,mdrender:false}}).then(function(res){var result=Object(__WEBPACK_IMPORTED_MODULE_1_immutable__[\"fromJS\"])(res.data.data);_this2.setState({topicInfo:result});}).catch(function(err){var errData=err.response.data;_this2.props.handleDialog({type:'danger',message:errData?errData.error_msg:'请求异常'});});}},{key:'handleTitleChange',value:function handleTitleChange(e){var title=e.target.value;if(title.length===0){this.setState(function(preState){return{topicError:preState.topicError.set('title','标题不能为空'),topicInfo:preState.topicInfo.set('title',title.trim())};});return;}if(title.length>100){this.setState(function(preState){return{topicError:preState.topicError.set('title','标题不能超过100个字')};});return;}this.setState(function(preState){return{topicError:preState.topicError.set('title',''),topicInfo:preState.topicInfo.set('title',title.trim())};});}},{key:'handleContentChange',value:function handleContentChange(e){var content=e.target.value;if(content.length===0){this.setState(function(preState){return{topicError:preState.topicError.set('content','内容不能为空'),topicInfo:preState.topicInfo.set('content',content.trim())};});return;}if(content.length>500){this.setState(function(preState){return{topicError:preState.topicError.set('content','内容不能超过500个字')};});return;}this.setState(function(preState){return{topicError:preState.topicError.set('content',''),topicInfo:preState.topicInfo.set('content',content.trim())};});}},{key:'handleTabChange',value:function handleTabChange(e){var tab=e.target.value;this.setState(function(preState){return{topicInfo:preState.topicInfo.set('tab',tab)};});}},{key:'handleTopicSubmit',value:function handleTopicSubmit(){var title=this.state.topicInfo.get('title'),content=this.state.topicInfo.get('content'),tab=this.state.topicInfo.get('tab'),accesstoken=this.props.entry.getIn(['userInfo','accesstoken']);try{if(this.state.topicInfo.get('title').length===0){this.setState(function(preState){return{topicError:preState.topicError.set('title','标题不能为空')};});throw new Error('标题不能为空');}if(this.state.topicInfo.get('content').length===0){this.setState(function(preState){return{topicError:preState.topicError.set('content','内容不能为空')};});throw new Error('内容不能为空');}if(this.state.topicError.get('content').length>0){throw new Error('内容过长');}if(this.state.topicError.get('title').length>0){throw new Error('标题过长');}}catch(err){return;}this.props.match.params.id?this.handleEditTopic({accesstoken:accesstoken,title:title,tab:tab,content:content,topic_id:this.props.match.params.id}):this.handleSubmitNewTopic({accesstoken:accesstoken,title:title,tab:tab,content:content});}},{key:'handleEditTopic',value:function handleEditTopic(_ref){var _this3=this;var accesstoken=_ref.accesstoken,title=_ref.title,tab=_ref.tab,content=_ref.content,topic_id=_ref.topic_id;__WEBPACK_IMPORTED_MODULE_2_axios___default.a.post('/topics/update',{accesstoken:accesstoken,title:title,tab:tab,content:content,topic_id:topic_id}).then(function(res){if(res.data.success){_this3.setState({time:setTimeout(function(){_this3.props.history.replace('/');},1000)});_this3.props.handleDialog({type:'success',message:'编辑成功'});}}).catch(function(err){var errData=err.response.data;_this3.props.handleDialog({type:'danger',message:errData?errData.error_msg:'编辑失败'});});}},{key:'handleSubmitNewTopic',value:function handleSubmitNewTopic(_ref2){var _this4=this;var accesstoken=_ref2.accesstoken,title=_ref2.title,tab=_ref2.tab,content=_ref2.content;__WEBPACK_IMPORTED_MODULE_2_axios___default.a.post('/topics',{accesstoken:accesstoken,title:title,tab:tab,content:content}).then(function(res){if(res.data.success){_this4.setState({time:setTimeout(function(){_this4.props.history.replace('/');},1000)});_this4.props.handleDialog({type:'success',message:'发帖成功'});}}).catch(function(err){var errData=err.response.data;_this4.props.handleDialog({type:'danger',message:errData?errData.error_msg:'发帖失败'});});}},{key:'componentWillUnmount',value:function componentWillUnmount(){window.clearTimeout(this.state.time);}},{key:'render',value:function render(){return __WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('article',{className:'container-fluid'},__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('section',{className:'container topic-index'},__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('form',{className:'pt-4 px-5 pb-2'},__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('div',{className:'form-group row'},__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('label',{htmlFor:'topicTitle',className:'col-sm-1 col-form-label'},'\\u6807\\u9898'),__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('div',{className:'col-sm-11'},__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('input',{type:'text',className:'form-control',id:'topicTitle',value:this.state.topicInfo.get('title'),onChange:this.handleTitleChange}),__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('p',{className:'text-danger topic-index_error pt-1'},this.state.topicError.get('title')))),__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('div',{className:'form-group row'},__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('label',{htmlFor:'topicContent',className:'col-sm-1 col-form-label'},'\\u5185\\u5BB9'),__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('div',{className:'col-sm-11'},__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('textarea',{className:'form-control',id:'topicContent',rows:'10',value:this.state.topicInfo.get('content'),onChange:this.handleContentChange}),__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('p',{className:'text-danger topic-index_error pt-1'},this.state.topicError.get('content')))),__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('div',{className:'form-group row'},__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('label',{htmlFor:'topicTab',className:'col-sm-1 col-form-label'},'\\u5206\\u7C7B'),__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('div',{className:'col-sm-11'},__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('select',{className:'form-control',id:'topicTab',value:this.state.topicInfo.get('tab'),onChange:this.handleTabChange},__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('option',{value:'ask'},'\\u95EE\\u7B54'),__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('option',{value:'share'},'\\u5206\\u4EAB'),__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('option',{value:'job'},'\\u5DE5\\u4F5C'),__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('option',{value:'dev'},'\\u6D4B\\u8BD5')),__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('p',{className:'text-danger topic-index_error pt-1'},'\\u5B98\\u65B9\\u8B66\\u544A\\uFF1A\\u8BF7\\u52A1\\u5FC5\\u5C06\\u4F60\\u4EEC\\u7684\\u6D4B\\u8BD5\\u5E16\\u53D1\\u5728 dev \\u4E13\\u533A\\uFF0C\\u4EE5\\u514D\\u6C61\\u67D3\\u65E5\\u5E38\\u7684\\u7248\\u9762\\uFF0C\\u5426\\u5219\\u4F1A\\u8FDB\\u884C\\u5C01\\u53F7\\u4E00\\u5468\\u5904\\u7406\\u3002')))),__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('footer',{className:'px-5 text-right pb-4'},__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('button',{type:'button',className:'btn btn-secondary',onClick:this.props.history.goBack},'\\u53D6\\u6D88'),'\\xA0\\xA0\\xA0\\xA0',__WEBPACK_IMPORTED_MODULE_0_react___default.a.createElement('button',{type:'button',className:'btn btn-primary',onClick:this.handleTopicSubmit},'\\u63D0\\u4EA4'))));}}]);return PostTopic;}(__WEBPACK_IMPORTED_MODULE_0_react__[\"Component\"]);/* harmony default export */ __webpack_exports__[\"default\"] = (PostTopic);\n\n/***/ }),\n\n/***/ 257:\n/***/ (function(module, exports, __webpack_require__) {\n\n// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = __webpack_require__(258);\nif(typeof content === 'string') content = [[module.i, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {\"hmr\":false}\noptions.transform = transform\n// add the styles to the DOM\nvar update = __webpack_require__(213)(content, options);\nif(content.locals) module.exports = content.locals;\n\n\n/***/ }),\n\n/***/ 258:\n/***/ (function(module, exports, __webpack_require__) {\n\nexports = module.exports = __webpack_require__(212)(true);\n// imports\n\n\n// module\nexports.push([module.i, \".topic-index{background:#fff}.topic-index .topic-index_error{font-size:12px}\", \"\", {\"version\":3,\"sources\":[\"/home/runner/work/react-app/react-app/src/pages/PostTopic/style.less\"],\"names\":[],\"mappings\":\"AAAA,aACE,eAAiB,CAClB,AACD,gCACE,cAAgB,CACjB\",\"file\":\"style.less\",\"sourcesContent\":[\".topic-index {\\n  background: #fff;\\n}\\n.topic-index .topic-index_error {\\n  font-size: 12px;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\n\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/topic.f1b146ac.chunk.js","import React, { Component } from 'react';\nimport { fromJS, Map } from 'immutable';\nimport axios from 'axios';\nimport './style.less';\n\nexport default class PostTopic extends Component {\n  constructor (props) {\n    super(props);\n    this.state = {\n      topicInfo: Map({\n        title: '',\n        tab: 'dev',\n        content: ''\n      }),\n      topicError: Map({\n        title: '',\n        content: ''\n      }),\n      time: null\n    };\n    this.handleTitleChange = this.handleTitleChange.bind(this);\n    this.handleContentChange = this.handleContentChange.bind(this);\n    this.handleTabChange = this.handleTabChange.bind(this);\n    this.handleTopicSubmit = this.handleTopicSubmit.bind(this);\n    this.handleSubmitNewTopic = this.handleSubmitNewTopic.bind(this);\n    this.handleEditTopic = this.handleEditTopic.bind(this);\n  }\n\n  componentDidMount () {\n    const baseBreadcrumb = this.props.match.params.id ? [\n      {\n        path: '/',\n        name: '首页'\n      },\n      {\n        path: '',\n        name: '编辑'\n      }\n    ] : [\n      {\n        path: '/',\n        name: '首页'\n      },\n      {\n        path: '',\n        name: '发贴'\n      }\n    ];\n    this.props.setBreadcrumb(baseBreadcrumb);\n    this.props.match.params.id && this.getDetail();\n  }\n\n  getDetail () {\n    const accesstoken = this.props.entry.getIn(['userInfo', 'accesstoken']);\n    axios.get(`/topic/${this.props.match.params.id}`, {params: {accesstoken, mdrender: false}})\n    .then(res => {\n      const result = fromJS(res.data.data);\n      this.setState({\n        topicInfo: result\n      });\n    })\n    .catch(err => {\n      const errData = err.response.data;\n      this.props.handleDialog({type: 'danger', message: errData ? errData.error_msg : '请求异常'});\n    });\n  }\n\n  handleTitleChange (e) {\n    const title = e.target.value;\n    if (title.length === 0) {\n      this.setState(preState => {\n        return {\n          topicError: preState.topicError.set('title', '标题不能为空'),\n          topicInfo: preState.topicInfo.set('title', title.trim())\n        };\n      });\n      return;\n    }\n    if (title.length > 100) {\n      this.setState(preState => {\n        return {\n          topicError: preState.topicError.set('title', '标题不能超过100个字')\n        };\n      });\n      return;\n    }\n    this.setState(preState => {\n      return {\n        topicError: preState.topicError.set('title', ''),\n        topicInfo: preState.topicInfo.set('title', title.trim())\n      };\n    });\n  }\n\n  handleContentChange (e) {\n    const content = e.target.value;\n    if (content.length === 0) {\n      this.setState(preState => {\n        return {\n          topicError: preState.topicError.set('content', '内容不能为空'),\n          topicInfo: preState.topicInfo.set('content', content.trim())\n        };\n      });\n      return;\n    }\n    if (content.length > 500) {\n      this.setState(preState => {\n        return {\n          topicError: preState.topicError.set('content', '内容不能超过500个字')\n        };\n      });\n      return;\n    }\n    this.setState(preState => {\n      return {\n        topicError: preState.topicError.set('content', ''),\n        topicInfo: preState.topicInfo.set('content', content.trim())\n      };\n    });\n  }\n\n  handleTabChange (e) {\n    const tab = e.target.value;\n    this.setState(preState => {\n      return {\n        topicInfo: preState.topicInfo.set('tab', tab)\n      };\n    });\n  }\n\n  handleTopicSubmit () {\n    const title = this.state.topicInfo.get('title'),\n      content = this.state.topicInfo.get('content'),\n      tab = this.state.topicInfo.get('tab'),\n      accesstoken = this.props.entry.getIn(['userInfo', 'accesstoken']);\n    try {\n      if (this.state.topicInfo.get('title').length === 0) {\n        this.setState(preState => {\n          return {\n            topicError: preState.topicError.set('title', '标题不能为空')\n          };\n        });\n        throw new Error('标题不能为空');\n      }\n      if (this.state.topicInfo.get('content').length === 0) {\n        this.setState(preState => {\n          return {\n            topicError: preState.topicError.set('content', '内容不能为空')\n          };\n        });\n        throw new Error('内容不能为空');\n      }\n      if (this.state.topicError.get('content').length > 0) {\n        throw new Error('内容过长');\n      }\n      if (this.state.topicError.get('title').length > 0) {\n        throw new Error('标题过长');\n      }\n    } catch (err) {\n      return;\n    }\n\n    this.props.match.params.id ? this.handleEditTopic({accesstoken, title, tab, content, topic_id: this.props.match.params.id}) : this.handleSubmitNewTopic({accesstoken, title, tab, content});\n  }\n\n  handleEditTopic ({accesstoken, title, tab, content, topic_id}) {\n    axios.post('/topics/update', {accesstoken, title, tab, content, topic_id})\n    .then(res => {\n      if (res.data.success) {\n        this.setState({\n          time: setTimeout(() => {\n            this.props.history.replace('/');\n          }, 1000)\n        });\n        this.props.handleDialog({type: 'success', message: '编辑成功'});\n      }\n    })\n    .catch(err => {\n      const errData = err.response.data;\n      this.props.handleDialog({type: 'danger', message: errData ? errData.error_msg : '编辑失败'});\n    });\n  }\n\n  handleSubmitNewTopic ({accesstoken, title, tab, content}) {\n    axios.post('/topics', {accesstoken, title, tab, content})\n    .then(res => {\n      if (res.data.success) {\n        this.setState({\n          time: setTimeout(() => {\n            this.props.history.replace('/');\n          }, 1000)\n        });\n        this.props.handleDialog({type: 'success', message: '发帖成功'});\n      }\n    })\n    .catch(err => {\n      const errData = err.response.data;\n      this.props.handleDialog({type: 'danger', message: errData ? errData.error_msg : '发帖失败'});\n    });\n  }\n\n  componentWillUnmount () {\n    window.clearTimeout(this.state.time);\n  }\n\n  render () {\n    return (\n      <article className=\"container-fluid\">\n        <section className='container topic-index'>\n          <form className='pt-4 px-5 pb-2'>\n            <div className=\"form-group row\">\n              <label htmlFor=\"topicTitle\" className=\"col-sm-1 col-form-label\">标题</label>\n              <div className=\"col-sm-11\">\n                <input type=\"text\" className=\"form-control\" id=\"topicTitle\" value={ this.state.topicInfo.get('title') } onChange={ this.handleTitleChange }/>\n                <p className='text-danger topic-index_error pt-1'>{ this.state.topicError.get('title') }</p>\n              </div>\n            </div>\n            <div className=\"form-group row\">\n              <label htmlFor=\"topicContent\" className=\"col-sm-1 col-form-label\">内容</label>\n              <div className=\"col-sm-11\">\n                <textarea className=\"form-control\" id=\"topicContent\" rows=\"10\" value={ this.state.topicInfo.get('content') } onChange={ this.handleContentChange }/>\n                <p className='text-danger topic-index_error pt-1'>{ this.state.topicError.get('content') }</p>\n              </div>\n            </div>\n            <div className=\"form-group row\">\n              <label htmlFor=\"topicTab\" className=\"col-sm-1 col-form-label\">分类</label>\n              <div className=\"col-sm-11\">\n                <select className=\"form-control\" id=\"topicTab\" value={ this.state.topicInfo.get('tab') } onChange={ this.handleTabChange }>\n                  <option value='ask'>问答</option>\n                  <option value='share'>分享</option>\n                  <option value='job'>工作</option>\n                  <option value='dev'>测试</option>\n                </select>\n                <p className='text-danger topic-index_error pt-1'>官方警告：请务必将你们的测试帖发在 dev 专区，以免污染日常的版面，否则会进行封号一周处理。</p>\n              </div>\n            </div>\n          </form>\n          <footer className='px-5 text-right pb-4'>\n            <button type=\"button\" className=\"btn btn-secondary\" onClick={ this.props.history.goBack }>取消</button>\n            &nbsp;&nbsp;&nbsp;&nbsp;\n            <button type=\"button\" className=\"btn btn-primary\" onClick={ this.handleTopicSubmit }>提交</button>\n          </footer>\n        </section>\n      </article>\n    );\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/PostTopic/index.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/index.js??ref--1-oneOf-2-2!../../../node_modules/postcss-loader/lib/index.js??postcss!../../../node_modules/less-loader/dist/cjs.js!./style.less\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// Prepare cssTransformation\nvar transform;\n\nvar options = {\"hmr\":false}\noptions.transform = transform\n// add the styles to the DOM\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\nif(content.locals) module.exports = content.locals;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/PostTopic/style.less\n// module id = 257\n// module chunks = 5","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \".topic-index{background:#fff}.topic-index .topic-index_error{font-size:12px}\", \"\", {\"version\":3,\"sources\":[\"/home/runner/work/react-app/react-app/src/pages/PostTopic/style.less\"],\"names\":[],\"mappings\":\"AAAA,aACE,eAAiB,CAClB,AACD,gCACE,cAAgB,CACjB\",\"file\":\"style.less\",\"sourcesContent\":[\".topic-index {\\n  background: #fff;\\n}\\n.topic-index .topic-index_error {\\n  font-size: 12px;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?{\"importLoaders\":1,\"minimize\":true,\"sourceMap\":true}!./node_modules/postcss-loader/lib?{\"ident\":\"postcss\",\"plugins\":[null,null]}!./node_modules/less-loader/dist/cjs.js!./src/pages/PostTopic/style.less\n// module id = 258\n// module chunks = 5"],"sourceRoot":""}